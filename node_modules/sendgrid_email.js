var sendgrid_username   = 'asell';
var sendgrid_password   = 'pennapps2014';

var sendgrid   = require('sendgrid')(sendgrid_username, sendgrid_password);
// create email templates
// conflict email template
var email_conflict     = new sendgrid.Email({
  from:     'MakeTime',
  subject:  'Schedule Conflict',
});

var email_reminder     = new sendgrid.Email({
  from:     'MakeTime',
  subject:  'Reminder!',
});

// send an email informing user of scheduling conflict
exports.sendConflictEmail = function (rescheduledEvent) {
	// set email text with input data
	email_conflict.setText('Hello, we noticed that you changed your schedule and now it conflicts with one of your tasks! We have rescheduled task ' + rescheduledEvent.summary +
  	' for you to this time: ' + rescheduledEvent.start.dateTime + 
  	'. Please log into MakeTime if you would like to change this.');

  	var email = rescheduledEvent.creator.email;
  	// set recipient
  	email_conflict.addTo(email);

	// send the email to the user
	sendgrid.send(email_conflict, function(err, json) {
  		if (err) { return console.error(err); }
  	console.log(json);
	});
};

// send an email reminding user of task
exports.sendReminderEmail = function (currentEvent) {
	// set email text with input data
	email_reminder.setText('Hello, we just wanted to remind you that you have a task scheduled now! Make sure you get it done or if you would like to reschedule it you can log into MakeTime and move it to a different time slot.');

  	var email = currentEvent.creator.email;
  	// set recipient
  	email_reminder.addTo(email);

	// send the email to the user
	sendgrid.send(email_reminder, function(err, json) {
  		if (err) { return console.error(err); }
  	console.log(json);
	});
};

